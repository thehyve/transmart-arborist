{% extends "layout.html" %}
{% block title %}Studies overview{% endblock %}
{% block content %}
	<p>Studies are recognized based on the folder containing a <code>study.params</code> or <code>clinical.params</code> file.</p>

	{% if not parentfolder == '' %}
		{% set parenturl = url_for('studies_overview', studiesfolder=parentfolder) %}
	{% else %}
		{% set parenturl = url_for('studies_overview_root') %}
	{% endif %}

	{% if not studiesfolder == '' %}
	<p><a href="{{ parenturl }}" id="gotoparent">Go to parent directory</a></p>
	{% endif %}

	<ul class="folderlist">
	{% for study in studies %}

		{% if not studiesfolder == '' %}
			{% set folderurl = url_for('studies_overview', studiesfolder=studiesfolder+'/'+study) %}
			{% set studyurl = url_for('study_page', studiesfolder=studiesfolder, study=study) %}
		{% else %}
			{% set folderurl = url_for('studies_overview', studiesfolder=study) %}
			{% set studyurl = url_for('study_page', studiesfolder=studiesfolder, study=study) %}
		{% endif %}

		{% if studies[study]['type'] == 'study' %}

		<li class="study">
			<a title="Use {{study}} as study" href="{{ studyurl }}"><img class="primary" src="{{ url_for('static', filename='img/tree/study.png') }}" style="vertical-align:text-bottom;opacity: 1;"></a>
			<a title="Navigate to folder {{study}}" data-foldername="{{study}}" class="gotofolder" href="{{ folderurl }}"><img class="secondary" data-foldername="{{study}}" src="{{ url_for('static', filename='img/tree/folder.gif') }}" style="vertical-align:text-bottom;opacity: 0.2;"></a>
			<a href="{{ studyurl }}">{{study}}</a>
		</li>

		{% else %}

		<li class="folder">
			<a title="Navigate to folder {{study}}" data-foldername="{{study}}" class="gotofolder" href="{{ folderurl }}"><img class="primary" data-foldername="{{study}}" src="{{ url_for('static', filename='img/tree/folder.gif') }}" style="vertical-align:text-bottom;opacity: 1;"></a>
			<a title="Use {{study}} as study" href="{{ studyurl }}"><img class="secondary" src="{{ url_for('static', filename='img/tree/study.png') }}" style="vertical-align:text-bottom;opacity: 0.2;"></a>
			<a data-foldername="{{study}}" class="gotofolder" href="{{ folderurl }}">{{study}}</a>
		</li>

		{% endif %}

	{% else %}
		<li>No studies</li>
	{% endfor %}

	</ul>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

<script>

$('img.secondary').hover(
  function () {
		$(this).closest( "li" ).find( "img.primary" ).css( "opacity", 0.2 );
		$(this).css( "opacity", 1 );
  },
  function () {
		$(this).closest( "li" ).find( "img.primary" ).css( "opacity", 1 );
		$(this).css( "opacity", 0.2 );
  }
);

</script>

{% endblock %}
